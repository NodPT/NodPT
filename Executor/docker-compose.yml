version: "3.9"

networks:
  backend_network:
    external: true

services:
  nodpt-executor:
    build:
      context: ..
      dockerfile: Executor/Dockerfile
    image: nodpt-executor:latest
    container_name: nodpt-executor
    pull_policy: always

    # ðŸ”¹ Load external environment file
    env_file:
      - /home/runner_user/envs/backend.env

    # ðŸ”¹ Expose backend port 
    ports:
      - "8848:8848"

    # ðŸ”¹ Environment variables for .NET Worker Service
    environment:
      - DOTNET_ENVIRONMENT=Production

    # ðŸ”¹ Docker networks for DB, backend & frontend
    networks:
      - backend_network

    # ðŸ”¹ Auto restart on failure
    restart: always
