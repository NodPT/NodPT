version: "3.9"

networks:
  backend_network:
    external: true #

services:
  nodpt-api:
    build:
      context: ..
      dockerfile: WebAPI/Dockerfile
    image: nodpt-api:latest
    container_name: nodpt-api
    pull_policy: always

    # ðŸ”¹ Load external environment file
    env_file:
      - /home/runner_user/envs/backend.env

    # ðŸ”¹ Expose backend port
    ports:
      - "8846:8846"

    # ðŸ”¹ Environment variables specific to ASP.NET Core
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
      - ASPNETCORE_URLS=http://0.0.0.0:8846
      - ASPNETCORE_HTTP_PORTS=8846

    # ðŸ”¹ Docker network for DB & backend
    networks:
      - backend_network

    # ðŸ”¹ Auto restart on failure
    restart: always
